const foodData = [{
    id: "1",
    Bestseller: "Bestseller",
    Title: "Falahari Sabudana Burger",
    OldPrice: "₹57.14",
    NewPrice: "₹49",
    Rating: "4.5",
    Count: "(3.1K+)",
    Description: "Falahaari sabudana Burger is a light, gluten-free dish made with soaked tapioca pearls, peanuts, and mild spices. Perfect for fasting days or a wh...",
    Image: "../IMG/food/Burger-removebg-preview.png"
},
{
    id: "2",
    Bestseller: "Bestseller",
    Title: "Falahari Sabudana cake",
    OldPrice: "₹170.14",
    NewPrice: "₹159",
    Rating: "4.5",
    Count: "(2.0K+)",
    Description: "Falahaari sabudana Cake is a light, gluten-free dish made with soaked tapioca pearls, peanuts, and mild spices. Perfect for fasting days or a wh...",
    Image: "../IMG/food/cake-removebg-preview.png"
},
{
    id: "3",
    Bestseller: "Bestseller",
    Title: "Falahari Sabudana chole-Bhature",
    OldPrice: "₹120.14",
    NewPrice: "₹100",
    Rating: "4.5",
    Count: "(8.7K+)",
    Description: "Falahaari sabudana Chole-Bhature is a light, gluten-free dish made with soaked tapioca pearls, peanuts, and mild spices. Perfect for fasting days or a wh...",
    Image: "../IMG/food/Chole_Bhature-removebg-preview.png"
},
{
    id: "4",
    Bestseller: "Bestseller",
    Title: "Falahari Sabudana Coffee",
    OldPrice: "₹40.14",
    NewPrice: "₹37",
    Rating: "4.5",
    Count: "(7.0K+)",
    Description: "Falahaari sabudana Coffee is a light, gluten-free dish made with soaked tapioca pearls, peanuts, and mild spices. Perfect for fasting days or a wh...",
    Image: "../IMG/food/Coffee-removebg-preview.png"
},
{
    id: "5",
    Bestseller: "Bestseller",
    Title: "Falahari Sabudana Dosa",
    OldPrice: "₹75.14",
    NewPrice: "₹70",
    Rating: "4.5",
    Count: "(1.1K+)",
    Description: "Falahaari sabudana Dosa is a light, gluten-free dish made with soaked tapioca pearls, peanuts, and mild spices. Perfect for fasting days or a wh...",
    Image: "../IMG/food/Dosa-removebg-preview.png"
},
{
    id: "6",
    Bestseller: "Bestseller",
    Title: "Falahari Sabudana ldli",
    OldPrice: "₹57.14",
    NewPrice: "₹50",
    Rating: "4.5",
    Count: "(4.1K+)",
    Description: "Falahaari sabudana ldli is a light, gluten-free dish made with soaked tapioca pearls, peanuts, and mild spices. Perfect for fasting days or a wh...",
    Image: "../IMG/food/Idli-removebg-preview.png"
},
{
    id: "7",
    Bestseller: "Bestseller",
    Title: "Falahari Sabudana Khichdi",
    OldPrice: "₹100.14",
    NewPrice: "₹90",
    Rating: "4.5",
    Count: "(6.1K+)",
    Description: "Falahaari sabudana Khichdi is a light, gluten-free dish made with soaked tapioca pearls, peanuts, and mild spices. Perfect for fasting days or a wh...",
    Image: "../IMG/food/Khichdi-removebg-preview.png"
},
{
    id: "8",
    Bestseller: "Bestseller",
    Title: "Falahari Sabudana Noodles",
    OldPrice: "₹57.14",
    NewPrice: "₹45",
    Rating: "4.5",
    Count: "(3.1K+)",
    Description: "Falahaari sabudana Noodles is a light, gluten-free dish made with soaked tapioca pearls, peanuts, and mild spices. Perfect for fasting days or a wh...",
    Image: "../IMG/food/Noodles-removebg-preview.png"
},
{
    id: "9",
    Bestseller: "Bestseller",
    Title: "Falahari Sabudana North_indian",
    OldPrice: "₹250",
    NewPrice: "₹149",
    Rating: "4.5",
    Count: "(1.0K+)",
    Description: "Falahaari sabudana North-indian is a light, gluten-free dish made with soaked tapioca pearls, peanuts, and mild spices. Perfect for fasting days or a wh...",
    Image: "../IMG/food/North_indian-removebg-preview.png"
},
{
    id: "10",
    Bestseller: "Bestseller",
    Title: "Falahari Sabudana Paratha",
    OldPrice: "₹57.14",
    NewPrice: "₹40",
    Rating: "4.5",
    Count: "(9.1K+)",
    Description: "Falahaari sabudana Paratha is a light, gluten-free dish made with soaked tapioca pearls, peanuts, and mild spices. Perfect for fasting days or a wh...",
    Image: "../IMG/food/Paratha-removebg-preview.png"
},
{
    id: "11",
    Bestseller: "Bestseller",
    Title: "Falahari Sabudana pasta",
    OldPrice: "₹55.14",
    NewPrice: "₹35",
    Rating: "4.5",
    Count: "(5.1K+)",
    Description: "Falahaari sabudana Pasta is a light, gluten-free dish made with soaked tapioca pearls, peanuts, and mild spices. Perfect for fasting days or a wh...",
    Image: "../IMG/food/pasta-removebg-preview.png"
},
{
    id: "12",
    Bestseller: "Bestseller",
    Title: "Falahari Sabudana pastry",
    OldPrice: "₹60.14",
    NewPrice: "₹40",
    Rating: "4.5",
    Count: "(7.1K+)",
    Description: "Falahaari sabudana Pastry is a light, gluten-free dish made with soaked tapioca pearls, peanuts, and mild spices. Perfect for fasting days or a wh...",
    Image: "../IMG/food/pastry-removebg-preview.png"
},
{
    id: "13",
    Bestseller: "Bestseller",
    Title: "Falahari Sabudana Pizza",
    OldPrice: "₹220.14",
    NewPrice: "₹199",
    Rating: "4.5",
    Count: "(2.1K+)",
    Description: "Falahaari sabudana Pizza is a light, gluten-free dish made with soaked tapioca pearls, peanuts, and mild spices. Perfect for fasting days or a wh...",
    Image: "../IMG/food/Pizza-removebg-preview.png"
},
{
    id: "14",
    Bestseller: "Bestseller",
    Title: "Falahari Sabudana Rolls",
    OldPrice: "₹30.14",
    NewPrice: "₹18",
    Rating: "4.5",
    Count: "(2.1K+)",
    Description: "Falahaari sabudana Rolls is a light, gluten-free dish made with soaked tapioca pearls, peanuts, and mild spices. Perfect for fasting days or a wh...",
    Image: "../IMG/food/Rolls-removebg-preview.png"
},
{
    id: "15",
    Bestseller: "Bestseller",
    Title: "Falahari Sabudana Salad",
    OldPrice: "₹46.14",
    NewPrice: "₹42",
    Rating: "6.5",
    Count: "(2.1K+)",
    Description: "Falahaari sabudana Salad is a light, gluten-free dish made with soaked tapioca pearls, peanuts, and mild spices. Perfect for fasting days or a wh...",
    Image: "../IMG/food/Salad-removebg-preview.png"
},
{
    id: "16",
    Bestseller: "Bestseller",
    Title: "Falahari Sabudana Samosa",
    OldPrice: "₹30.14",
    NewPrice: "₹25",
    Rating: "4.5",
    Count: "(2.1K+)",
    Description: "Falahaari sabudana Samosa is a light, gluten-free dish made with soaked tapioca pearls, peanuts, and mild spices. Perfect for fasting days or a wh...",
    Image: "../IMG/food/Samosa-removebg-preview.png"
},
{
    id: "17",
    Bestseller: "Bestseller",
    Title: "Falahari Sabudana Shake",
    OldPrice: "₹150.14",
    NewPrice: "₹145",
    Rating: "4.5",
    Count: "(2.3K+)",
    Description: "Falahaari sabudana Shake is a light, gluten-free dish made with soaked tapioca pearls, peanuts, and mild spices. Perfect for fasting days or a wh...",
    Image: "../IMG/food/Shake-removebg-preview.png"
},
{
    id: "18",
    Bestseller: "Bestseller",
    Title: "Falahari Sabudana Tea",
    OldPrice: "₹25.14",
    NewPrice: "₹15",
    Rating: "4.5",
    Count: "(2.0K+)",
    Description: "Falahaari sabudana Tea is a light, gluten-free dish made with soaked tapioca pearls, peanuts, and mild spices. Perfect for fasting days or a wh...",
    Image: "../IMG/food/Tea-removebg-preview.png"
},
{
    id: "19",
    Bestseller: "Bestseller",
    Title: "Falahari Sabudana Vada",
    OldPrice: "₹70.14",
    NewPrice: "₹60",
    Rating: "4.5",
    Count: "(4.3K+)",
    Description: "Falahaari sabudana vada is a light, gluten-free dish made with soaked tapioca pearls, peanuts, and mild spices. Perfect for fasting days or a wh...",
    Image: "../IMG/food/Vada-removebg-preview.png"
},
];

// 1. URL se search query nikalein
const urlParams = new URLSearchParams(window.location.search);
const searchTerm = urlParams.get('lokesh'); // 'lokesh' wohi naam hai jo humne search.js mein diya tha

let dataToDisplay = foodData;
// 2. Agar koi search term aya hai, toh filter karein
if (searchTerm) {
    const cleanSearchTerm = searchTerm.toLowerCase();
    dataToDisplay = foodData.filter((item) => {
        return item.Title.toLowerCase().includes(cleanSearchTerm) ||
            item.Description.toLowerCase().includes(cleanSearchTerm);
    });
}

const mainContainer = document.getElementById("food-container");
const mainContainer2 = document.getElementById("food-container2");
let subtotal = document.getElementById("total")

let cart = [];
const ul = document.getElementById('list'); //for shoping card

const value1 = document.getElementById("value1")
let globlevalue = 0;
// foodData.forEach((i) => {
dataToDisplay.forEach((i) => {

    //  Card Wrapper
    const card = document.createElement("div");
    card.className = "w-full max-w-4xl bg-white p-4 shadow-sm  relative";

    //  Flex Row (Left Info + Right Image)
    const row = document.createElement("div");
    row.className = "flex justify-between items-start py-8 border-b border-gray-200";

    // --- LEFT SIDE (Text Info) ---
    const leftCol = document.createElement("div");
    leftCol.className = "flex-1 pr-4";

    //  Bestseller Badge
    const badgeDiv = document.createElement("div");
    badgeDiv.className = "flex items-center gap-2 mb-1";

    // Green Dot Icon
    const dotBox = document.createElement("div");
    dotBox.className = "border-2 border-green-600 w-4 h-4 flex justify-center items-center p-[1px]";
    const dot = document.createElement("div");
    dot.className = "w-2 h-2 bg-green-600 rounded-full";
    dotBox.append(dot); // Append Dot

    // Star + Text
    const badgeTextDiv = document.createElement("div");
    badgeTextDiv.className = "flex items-center text-[#ee5f00] text-xs font-bold gap-1";
    const badgeIcon = document.createElement("i");
    badgeIcon.className = "fa-solid fa-star text-[10px]";
    const badgeLabel = document.createElement("span");
    // badgeLabel.append(foodData[0]); // Data: "Bestseller"
    badgeLabel.textContent = i.Bestseller
    badgeTextDiv.append(badgeIcon, badgeLabel);
    // badgeTextDiv.append();


    badgeDiv.append(dotBox, badgeTextDiv); // Append all to Badge Row

    //  Title
    const title = document.createElement("h3");
    title.className = "font-bold text-lg text-text-main mb-1";
    title.textContent = i.Title; // Data: Title

    //  Price Row
    const priceDiv = document.createElement("div");
    priceDiv.className = "flex items-center gap-2 text-sm mb-2";
    const oldPrice = document.createElement("span");
    oldPrice.className = "line-through text-gray-400";
    oldPrice.textContent = i.OldPrice; // Data: Old Price

    const newPrice = document.createElement("span");
    newPrice.className = "text-text-main font-semibold";
    newPrice.textContent = i.NewPrice; // Data: New Price

    const tagIcon = document.createElement("i");
    tagIcon.className = "fa-solid fa-tag text-green-600 text-xs";

    priceDiv.append(oldPrice, newPrice, tagIcon);

    //  Rating Row
    const ratingDiv = document.createElement("div");
    ratingDiv.className = "flex items-center gap-1 mb-2";
    const starIcon = document.createElement("i");
    starIcon.className = "fa-solid fa-star text-green-700 text-xs";

    const score = document.createElement("span");
    score.className = "text-green-700 font-bold text-xs";
    score.textContent = i.Rating; // Data: Rating

    const count = document.createElement("span");
    count.className = "text-gray-500 text-xs";
    count.textContent = i.Count; // Data: Count

    ratingDiv.append(starIcon, score, count);

    //  Description
    const desc = document.createElement("p");
    desc.className = "text-text-desc text-sm leading-tight line-clamp-2";
    desc.textContent = i.Description; // Data: Description

    // Append everything to Left Column
    leftCol.append(badgeDiv, title, priceDiv, ratingDiv, desc);


    // --- RIGHT SIDE (Image + Button) ---
    const rightCol = document.createElement("div");
    rightCol.className = "relative w-[118px] shrink-0";

    // Image
    const img = document.createElement("img");
    img.src = i.Image; // Data: Image URL
    img.alt = "Food Item";
    img.className = "w-full h-full object-cover rounded-xl shadow-sm";

    // Button Container
    const btnContainer = document.createElement("div");
    btnContainer.className = "absolute -bottom-1 left-1/2 -translate-x-1/2 w-24 bg-white font-extrabold text-sm  rounded shadow-md border border-gray-300 text-center flex justify-evenly cursor-pointer hover:bg-gray-50 uppercase";

    const btnInc = document.createElement("button");
    btnInc.className = "text-2xl text-green-600";
    btnInc.append("+");

    const btnVal = document.createElement("button");
    btnVal.className = "text-lg text-orange-600";
    btnVal.append("ADD");

    const btnDec = document.createElement("button");
    btnDec.className = "text-2xl text-green-600";
    btnDec.append("-");

    btnContainer.append(btnDec, btnVal, btnInc);

    // Append to Right Column
    rightCol.append(img, btnContainer);

    row.append(leftCol, rightCol);

    card.append(row);

    mainContainer.append(card);


    let value = 0;

    btnInc.addEventListener("click", () => {
        addToCart(i);
        value++;
        // globlevalue++;
        btnVal.textContent = `${value}`
        // value1.textContent = `${globlevalue}`
    })


    btnVal.addEventListener("click", () => {
        addToCart(i);
        if (value === 0) {
            value++;
            // globlevalue++;
            btnVal.textContent = `${value}`
            // value1.textContent = `${globlevalue}`
        }
    })

    btnDec.addEventListener("click", () => {
        if (value > 0) {
            value--;
            delToCart(i)
            // globlevalue--;

            btnVal.textContent = value === 0 ? "ADD" : `${value}`;
            // value1.textContent = globlevalue === 0 ? "" : `${globlevalue}`;
        }

        if (value === 0) {
            removeFromCart(i)
        }
        // value1.textContent = value === 0 ? "" : `${value}`;

    })

});



const randomFoodList = [...foodData].sort(() => 0.5 - Math.random());

randomFoodList.forEach((i) => {
    //  Card Wrapper
    const card = document.createElement("div");
    card.className = "w-full max-w-4xl bg-white p-4 shadow-sm  relative";

    //  Flex Row (Left Info + Right Image)
    const row = document.createElement("div");
    row.className = "flex justify-between items-start py-8 border-b border-gray-200";

    // --- LEFT SIDE (Text Info) ---
    const leftCol = document.createElement("div");
    leftCol.className = "flex-1 pr-4";

    //  Bestseller Badge
    const badgeDiv = document.createElement("div");
    badgeDiv.className = "flex items-center gap-2 mb-1";

    // Green Dot Icon
    const dotBox = document.createElement("div");
    dotBox.className = "border-2 border-green-600 w-4 h-4 flex justify-center items-center p-[1px]";
    const dot = document.createElement("div");
    dot.className = "w-2 h-2 bg-green-600 rounded-full";
    dotBox.append(dot); // Append Dot

    // Star + Text
    const badgeTextDiv = document.createElement("div");
    badgeTextDiv.className = "flex items-center text-[#ee5f00] text-xs font-bold gap-1";
    const badgeIcon = document.createElement("i");
    badgeIcon.className = "fa-solid fa-star text-[10px]";
    const badgeLabel = document.createElement("span");
    // badgeLabel.append(foodData[0]); // Data: "Bestseller"
    badgeLabel.textContent = i.Bestseller
    badgeTextDiv.append(badgeIcon, badgeLabel);
    // badgeTextDiv.append();


    badgeDiv.append(dotBox, badgeTextDiv); // Append all to Badge Row

    //  Title
    const title = document.createElement("h3");
    title.className = "font-bold text-lg text-text-main mb-1";
    title.textContent = i.Title; // Data: Title

    //  Price Row
    const priceDiv = document.createElement("div");
    priceDiv.className = "flex items-center gap-2 text-sm mb-2";
    const oldPrice = document.createElement("span");
    oldPrice.className = "line-through text-gray-400";
    oldPrice.textContent = i.OldPrice; // Data: Old Price

    const newPrice = document.createElement("span");
    newPrice.className = "text-text-main font-semibold";
    newPrice.textContent = i.NewPrice; // Data: New Price

    const tagIcon = document.createElement("i");
    tagIcon.className = "fa-solid fa-tag text-green-600 text-xs";

    priceDiv.append(oldPrice, newPrice, tagIcon);

    //  Rating Row
    const ratingDiv = document.createElement("div");
    ratingDiv.className = "flex items-center gap-1 mb-2";
    const starIcon = document.createElement("i");
    starIcon.className = "fa-solid fa-star text-green-700 text-xs";

    const score = document.createElement("span");
    score.className = "text-green-700 font-bold text-xs";
    score.textContent = i.Rating; // Data: Rating

    const count = document.createElement("span");
    count.className = "text-gray-500 text-xs";
    count.textContent = i.Count; // Data: Count

    ratingDiv.append(starIcon, score, count);

    //  Description
    const desc = document.createElement("p");
    desc.className = "text-text-desc text-sm leading-tight line-clamp-2";
    desc.textContent = i.Description; // Data: Description

    // Append everything to Left Column
    leftCol.append(badgeDiv, title, priceDiv, ratingDiv, desc);


    // --- RIGHT SIDE (Image + Button) ---
    const rightCol = document.createElement("div");
    rightCol.className = "relative w-[118px] shrink-0";

    // Image
    const img = document.createElement("img");
    img.src = i.Image; // Data: Image URL
    img.alt = "Food Item";
    img.className = "w-full h-full object-cover rounded-xl shadow-sm";

    // Button Container
    const btnContainer = document.createElement("div");
    btnContainer.className = "absolute -bottom-1 left-1/2 -translate-x-1/2 w-24 bg-white font-extrabold text-sm  rounded shadow-md border border-gray-300 text-center flex justify-evenly cursor-pointer hover:bg-gray-50 uppercase";

    const btnInc = document.createElement("button");
    btnInc.className = "text-2xl text-green-600";
    btnInc.append("+");

    const btnVal = document.createElement("button");
    btnVal.className = "text-lg text-orange-600";
    btnVal.append("ADD");
    btnVal.id = `btn-${i.id}`;

    const btnDec = document.createElement("button");
    btnDec.className = "text-2xl text-green-600";
    btnDec.append("-");

    btnContainer.append(btnDec, btnVal, btnInc);

    // Append to Right Column
    rightCol.append(img, btnContainer);

    row.append(leftCol, rightCol);

    card.append(row);

    mainContainer2.append(card);

    let value = 0;
    btnInc.addEventListener("click", () => {
        addToCart(i);
        value++;
        btnVal.textContent = `${value}`
        // value1.textContent = `${globlevalue}`
    })


    btnVal.addEventListener("click", () => {
        addToCart(i);
        if (value === 0) {
            value++;
            btnVal.textContent = `${value}`
            // value1.textContent = `${globlevalue}`
        }
    })

    btnDec.addEventListener("click", () => {
        if (value > 0) {
            value--;
            delToCart(i)
            btnVal.textContent = value === 0 ? "ADD" : `${value}`;
            // value1.textContent = globlevalue === 0 ? "" : `${globlevalue}`;
        }

        if (value === 0) {
            btnVal.textContent = "ADD"; // Agar 0 ho gaya to wapas "ADD" likh do
            removeFromCart(i)

        }
    })

});

function renderCart() {
    ul.innerHTML = "";
    cart.forEach((i) => {
        // 1. Main List Item (<li>)
        const li = document.createElement('li');
        li.className = "flex py-6";

        // 2. Image Container (div 1)
        const imgContainer = document.createElement('div');
        imgContainer.className = "size-24 shrink-0 overflow-hidden rounded-md";

        const img = document.createElement('img');
        img.src = i.Image;
        img.className = "size-full object-cover";

        imgContainer.appendChild(img); // Image ko container me dala

        // 3. Content Container (div 2)
        const contentContainer = document.createElement('div');
        contentContainer.className = "ml-4 flex flex-1 flex-col";

        // --- 3.1 Top Section (div 2.1) ---
        const topSection = document.createElement('div');

        // Title and Price Row (div 2.1.1)
        const titlePriceRow = document.createElement('div');
        titlePriceRow.className = "flex justify-between text-base font-medium text-gray-900";

        const h3 = document.createElement('h3');
        const link = document.createElement('a');
        link.href = "#";
        link.textContent = i.Title;
        h3.appendChild(link);

        const price = document.createElement('p');
        price.className = "ml-4";
        price.textContent = i.NewPrice;

        titlePriceRow.appendChild(h3);
        titlePriceRow.appendChild(price);

        // Description (Salmon)
        const description = document.createElement('p');
        description.className = "mt-1 text-sm text-gray-500";
        description.textContent = i.Bestseller;

        // Top Section me sab append kiya
        topSection.appendChild(titlePriceRow);
        topSection.appendChild(description);

        // --- 3.2 Bottom Section (div 2.2) ---
        const bottomSection = document.createElement('div');
        bottomSection.className = "flex flex-1 items-end justify-between text-sm";

        const qty = document.createElement('p');
        qty.className = "text-gray-500";
        // qty.textContent = `Qty:${Qty}`;
        qty.textContent = `Qty : ${i.quantity}`
        // qty.textContent = `${value}`


        const btnContainer = document.createElement('div');
        btnContainer.className = "flex";

        const removeBtn = document.createElement('button');
        removeBtn.type = "button";
        removeBtn.className = "font-medium text-indigo-600 hover:text-indigo-500";
        removeBtn.textContent = "Remove";
        removeBtn.onclick = function () {
            removeFromCart(i);
        };


        btnContainer.appendChild(removeBtn);

        // Bottom Section me sab append kiya
        bottomSection.append(qty, btnContainer);
        contentContainer.append(topSection, bottomSection);
        li.append(imgContainer, contentContainer);

        ul.appendChild(li);
        
    });
};

function addToCart(item) {
    const existingItem = cart.find(cartItem => cartItem.id === item.id);
    // console.log("helo", existingItem)

    if (existingItem) {
        existingItem.quantity += 1
    } else {
        cart.push({ ...item, quantity: 1 });
        globlevalue++;
        value1.textContent = `${globlevalue}`
    }
    // subtotal.textContent =`${item.NewPrice}`
    updateSubtotal();
    renderCart();
}


function delToCart(item) {
    const existingItem = cart.find(cartItem => cartItem.id === item.id);
    console.log("helo", existingItem)

    if (existingItem) {
        existingItem.quantity -= 1
    }
    updateSubtotal(); 
    renderCart();
}

function removeFromCart(item) {
    // const existingItem = cart.find(cartItem => cartItem.id === item.id);
    const index = cart.findIndex(cartItem => cartItem.id === item.id);

    if (index > -1) {
        // cart.pop({ ...item, quantity: 1 });
        cart.splice(index, 1);
        globlevalue--;
        value1.textContent = `${globlevalue}`;
        if (globlevalue === 0) {
            value1.textContent = `${""}`;
        }
        // const mainButton = document.getElementById(`btn-${item.id}`);
        // if (mainButton) {
        //     mainButton.innerText = "ADD"; 
        // }
    }
    updateSubtotal(); 
    renderCart();
}



// calculate total
function updateSubtotal() {
    let totalAmount = 0;

    cart.forEach((item) => {
        // number me convert kar ke
        let priceString = item.NewPrice.replace("₹","").trim();

        totalAmount += priceString * item.quantity;
    });

    subtotal.textContent = `₹${totalAmount}`;
}

